version: 2

models:
  - name: questions_latest
    description: "{{ doc('questions_latest') }}"
    meta:
      owner: Christopher Lewis
      domain: stack_overflow
      layer: report
      maturity: low

    columns:
      - name: question_id
        description: "Stack Overflow question identifier. Grain of this model: **1 row per question_id** (latest by activity)."
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('stg_so_questions')
              field: question_id

      - name: title
        description: "Latest known title for the question based on last_activity_ts, then creation_ts."
        tests:
          - not_null

      - name: question_url
        description: "Canonical URL for the question. Falls back to https://stackoverflow.com/questions/<question_id> when missing upstream."
        tests:
          - not_null
